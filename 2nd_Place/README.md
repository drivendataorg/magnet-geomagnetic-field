# Folder contents
- `train.py`: Training code. (This has been modified slightly from the version I used totrain my submission: I removed some testing code, and added some more explana-tory comments. However the code that produces the trained models is unchanged.)
- `predict.py`: Prediction code.
- 10 tensorflow model files in .h5 format, generated by `train.py`.
- `normdf.csv`: Median and quartiles for the model features, used to normalise thedata before prediction, generated by `train.py`. Required for submission.
- `requirementsgpu.txt`: Requirements for running the training code on a GPU machine.
- `requirementscpu.txt`: Requirements for running the training code on a CPU machine.
- `Readme.pdf`: Contains instructions for running the code to reproduce mysubmission. Also includes the model documentation, with detailed description of the modelling approach. This can also be found in `/reports/`
- `LICENSE.txt`: MIT license.

# Reproducing the submission
The code can be run on GPU or CPU. I used GPU for training my submission, but CPU takes only slightly more time (16 minutes vs 11 minutes) and is probably easier to reproduce, so I recommend CPU for reproducing the submission. Iâ€™ve tested that the instructions below for CPU can be used to build a working environment starting witha plain Ubuntu instance on AWS (in contrast, for the GPU training, I started from a pre-built instance with the Python environment already set up and I have not tested building the environment from `requirementsgpu.txt`).

## Environment for CPU (recommended)
Training on CPU takes around 16 minutes.The following instructions can be used to set up the Python environment, starting from a basic Ubuntu Linux install. I tested these instructions on an AWS Ubuntu Linux cloud instance (instance type t2.2xlarge)

1. Download and install Anaconda:
    - `wget https :// repo.anaconda.com/archive/Anaconda3 -2020.11 - Linux -x86_64.shbash Anaconda3 -2020.11 - Linux -x86_64.sh`
2. Create a new conda environment and activate it:
    - `conda create --name tf python=3.8`
    - `conda activate tf3`.
3. Install `gcc` if not already installed:
    - `sudo apt -get install gcc4`.
4. Install the pip packages from the requirements file:
    - `python -m pip install -r requirements_cpu.txt`

## Environment for GPU
I used an AWS Ubuntu Linux cloud instance (instance type p2.xlarge). I used a pre-built image with the Python environment already set up (but I think I also changed some package versions). Packages are in `requirementsgpu.txt`. Training takes around 11 minutes.

## Running the code
The input csv files should go in a subdirectory called `data`. To train the models run `train.py`, which generates 10 model files and `normdf.csv`. The files needed to submit an entry are `predict.py`, the 10 model files, and `normdf.csv`.
